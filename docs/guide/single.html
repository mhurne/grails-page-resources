<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>Page Resources Plugin 0.2.4-SNAPSHOT</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
    </head>

    <body class="body" onload="addJsClass();">
        <div id="navigation">
            <ul>
                <li>
                    <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                        <a href="../guide/index.html" class="button">Table of contents</a>
                        <div id="nav-summary-childs" style="display:none;">
                            
                            <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#usage"><strong>2</strong><span>Usage</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#example"><strong>3</strong><span>Example Scenario</span></a></div>
                            
                        </div>
                    </div>
                </li>
                <li class="separator selected">
                    <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
                </li>
            </ul>
        </div>
        <div id="header">
            <div class="images clearfix">
                
                
            </div>
            <p>Enhances the resources plugin by allowing for creation of &quot;page&quot; resource modules using convention over configuration.</p>
        </div>


        <table id="colset" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td id="col1">
                    <div id="main" class="corner-all">

                        <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                        <div class="project">
                            <h1>Page Resources Plugin - Reference Documentation</h1>
                            <p><strong>Authors:</strong> David M. Carr</p>
                            <p><strong>Version:</strong> 0.2.4-SNAPSHOT</p>
                            
                        </div>

                        
                        <div id="table-of-content">
                            <h2>Table of Contents</h2>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#releaseNotes"><strong>1.1</strong><span>Release Notes</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#usage"><strong>2</strong><span>Usage</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#example"><strong>3</strong><span>Example Scenario</span></a></div>
                            
                            <div style="clear:both" ></div>
                        </div>
                        
                        

<h1 id="introduction">1 Introduction</h1>
The Page Resources plugin provides the <a href="http://grails.org/plugin/resources" target="blank">Grails Resources plugin</a> with the ability to
use convention over configuration to define "page modules", which allow having page-specific resources (JavaScript, CSS,
LESS, etc.).  This can drastically cut down on the number of resource modules that need to be configured explicitly.



<h2 id="releaseNotes">1.1 Release Notes</h2>
Below is the history of Page Resource plugin releases.<p class="paragraph"/><h4>0.2.4 (Next release)</h4>
<ul class="star">
<li>Features TBD</li>
<li>Shifted hosting from BitBucket to GitHub</li>
</ul><p class="paragraph"/><h4>0.2.3 (Released 12-11-2012)</h4>
<ul class="star">
<li>Backout "Don't export dependency on spring-webflow"</li>
</ul><p class="paragraph"/><h4>0.2.2 (Released 12-10-2012)</h4>
<ul class="star">
<li>Don't export dependency on spring-webflow ( <a href="https://bitbucket.org/davidmc24/grails-page-resources/pull-request/1" target="blank">Bitbucket Pull Request #1</a> )</li>
</ul><p class="paragraph"/><h4>0.2.1 (Released 11-22-2012)</h4>
<ul class="star">
<li>Fixes compilation when webflow plugin is not installed ( <a href="https://bitbucket.org/davidmc24/grails-page-resources/issue/1" target="blank">Bitbucket Issue #1</a> )</li>
</ul><p class="paragraph"/><h4>0.2.0 (Released 11-21-2012)</h4>
<ul class="star">
<li>Updated dependency on resources plugin to 1.2.RC2</li>
<li>New configuration option to enable bundling within page resource modules ( <a href="https://github.com/davidmc24/grails-page-resources/issues/6" target="blank">GitHub Issue #6</a> )</li>
<li>Added support for running in a non-expanded WAR ( <a href="https://github.com/davidmc24/grails-page-resources/issues/3" target="blank">GitHub Issue #3</a> )</li>
<li>Added support for automatically requiring page modules for webflows ( <a href="https://github.com/davidmc24/grails-page-resources/issues/5" target="blank">GitHub Issue #5</a> )</li>
<li>Shifted primary hosting from <a href="https://github.com/davidmc24/grails-page-resources" target="blank">GitHub</a> to <a href="https://bitbucket.org/davidmc24/grails-page-resources" target="blank">Bitbucket</a></li>
</ul><p class="paragraph"/><h4>0.1.2 (Released 7-31-2012)</h4>
<ul class="star">
<li>Fixed IllegalArgumentException on unsupported files in pages directory ( <a href="https://github.com/davidmc24/grails-page-resources/issues/2" target="blank">GitHub Issue #2</a> )</li>
<li>Fixed loading of new page resource files ( <a href="https://github.com/davidmc24/grails-page-resources/issues/4" target="blank">GitHub Issue #4</a> )</li>
</ul><p class="paragraph"/><h4>0.1.1 (Released 7-18-2012)</h4>
<ul class="star">
<li>Fixed IllegalArgumentException on Windows ( <a href="https://github.com/davidmc24/grails-page-resources/issues/1" target="blank">GitHub Issue #1</a> )</li>
</ul><p class="paragraph"/><h4>0.1 (Released 7-17-2012)</h4>
<ul class="star">
<li>Initial release</li>
</ul><p class="paragraph"/>


<h1 id="usage">2 Usage</h1>
<h4>Installation</h4><p class="paragraph"/>Install the plugin by adding the following to your <code>BuildConfig.groovy</code> (replace <code>VERSION</code> with the desired version):<p class="paragraph"/><div class="code"><pre>plugins &#123;
    &#8230;
    runtime ':page&#45;resources:VERSION'
&#125;</pre></div><p class="paragraph"/>If you need to use a different version of spring-webflow than the plugin was developed with, you can use this instead:<p class="paragraph"/><div class="code"><pre>plugins &#123;
    &#8230;
    runtime(':page&#45;resources:VERSION') &#123;
        excludes 'spring&#45;webflow'
    &#125;
&#125;</pre></div><p class="paragraph"/><h4>Creating page modules</h4><p class="paragraph"/>Next, you'll need to create some page modules.  Within <code>web-app/pages</code>, create a directory structure that parallels the
path to a view.  For example, if you have a file <code>grails-app/views/user/view.gsp</code>, you would create directory
<code>web-app/pages/user/view</code>.  Create any page-specific resources that you want the view to include in this directory.
For example, if the page requires special styling you can add .css or .less files, or if the page requires special
Javascript behavior you can add .js files.  For every such directory that contains files, a resource module will be
automatically created, and the view will automatically require it.  In this example, the module would be named
"pages_user_view" (the directory path with slashes replaced with underscores).  Files in the directory are included
in the module in alphabetical order.<p class="paragraph"/><h4>Default page dependencies</h4><p class="paragraph"/>You may have some JavaScript libraries that your page-specific scripts use.  A JavaScript framework such as jQuery
would be a common example of this.  You need to tell the resources plugin about these dependencies, or they may be
included in the wrong ordering, resulting in JavaScript errors.  These situations can often be resolved using a default
page dependencies module.  If you
<a href="http://grails-plugins.github.com/grails-resources/guide/3.%20Declaring%20resources.html" target="blank">declare a resource module</a>
named <code>defaultPageDependencies</code>, the page modules will automatically list it as a dependency.  If you list all your
commonly used libraries as dependencies in your <code>defaultPageDependencies</code> module, you generally won't need to do any
page-specific configuration for most views.  If you need to list dependencies not appropriate for the default page
dependencies, please see the "Explicit page module definitions" section below.<p class="paragraph"/><h4>Explicit page module definitions</h4><p class="paragraph"/>In some cases, you may need additional control over the contents of the resource module for a page.  Examples of this
include when you need to vary from the default page dependencies, when you need to include additional resources in
the page module, or when you need to specify special processing for particular resources in the module.  In these cases,
simply
<a href="http://grails-plugins.github.com/grails-resources/guide/3.%20Declaring%20resources.html" target="blank">declare a resource module</a>
with the same name as would have been automatically created (pages_<strong class="bold">PATH</strong>_<strong class="bold">VIEWNAME</strong>).  The Page Resources plugin will
use your definition for the module rather than automatically create one, and will still automatically require the module
in the view.<p class="paragraph"/>Another option is to <a href="http://grails-plugins.github.com/grails-resources/guide/5.%20Overriding%20resources.html" target="blank">override resources</a>
in the automatically defined page module.<p class="paragraph"/><h4>Resource Bundling</h4><p class="paragraph"/>Since page resources are by definition specific to a single page and not intended for sharing, they aren't a good
conceptual fit for <a href="http://grails-plugins.github.com/grails-resources/guide/3.%20Declaring%20resources.html#3.4%20Bundling" target="blank">bundling</a>.
By default, the page resources plugin sets "defaultBundle(false)" for each page module.  This disables the default bundling
that the resources plugin would otherwise do for modules with more than one resource, allowing for more understandable path
names (unless you're using something like the <a href="http://grails.org/plugin/cached-resources" target="blank">cached-resources</a> plugin, of course).<p class="paragraph"/><blockquote class="note">
In general, if you find you're running into performance problems that might be resolved via bundling, you should consider
attempting to reduce the number of page modules you use.
</blockquote><p class="paragraph"/>If you want to allow auto-bundling to occur, add the following to your <code>Config.groovy</code>:<p class="paragraph"/><div class="code"><pre>grails.plugins.pageResources.defaultBundle = <span class="java&#45;keyword">true</span></pre></div><p class="paragraph"/>Alternatively, if you want all page modules to use a single bundle, you can set this configuration key to a String value, which
will be passed to the resources plugin as the argument to defaultBundle for every page module.



<h1 id="example">3 Example Scenario</h1>
Here, we'll create an example application and run through a couple example usages of the plugin.<p class="paragraph"/>Run the following commands to generate some scaffolding.  This will give us a simple app with a domain class and some
views.
<ul class="star">
<li>grails create-app grails-page-resources-test</li>
<li>cd grails-page-resources-test</li>
<li>grails create-domain-class org.bookstore.Book</li>
<li>Edit grails-app/domain/org/bookstore/Book.groovy to add a few fields:</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">package</span> org.bookstore<p class="paragraph"/>class Book &#123;
    <span class="java&#45;object">Long</span> id
    <span class="java&#45;object">Long</span> version<p class="paragraph"/>    <span class="java&#45;object">String</span> title
    <span class="java&#45;object">String</span> author<p class="paragraph"/>    <span class="java&#45;keyword">static</span> constraints = &#123;
    &#125;
&#125;</pre></div>
<ul class="star">
<li>grails generate-all org.bookstore.Book</li>
<li>grails run-app (kill it when you're done examining the app)</li>
</ul><p class="paragraph"/>We now have a running, very simple app that allows you to perform CRUD operations on Books.  Now, let's say that we
don't want in-line JavaScript, such as for the confirmation pop-up for the delete button.  We can pull that out into
a page-specific JavaScript resource file.
<ul class="star">
<li>Edit conf/BuildConfig.groovy to install the page-resources plugin (and jquery, since we'll use it later):</li>
</ul><p class="paragraph"/><div class="code"><pre>&#46;..
    plugins &#123;
        &#46;..
        runtime <span class="java&#45;quote">"&#58;page&#45;resources&#58;"</span>
        runtime <span class="java&#45;quote">"&#58;jquery&#58;"</span>
    &#125;
&#125;</pre></div>
<ul class="star">
<li>The page with the delete link is "/book/show/ID", so create web-app/pages/book/show/deleteConfirmation.js.  The filename can be whatever you want, but the path must match the controller/action.</li>
</ul><p class="paragraph"/><div class="code"><pre>$(document).ready(function() &#123;
    $('form').submit(function(event) &#123;
        <span class="java&#45;keyword">if</span> (!confirm(<span class="java&#45;quote">"Are you sure?"</span>)) event.preventDefault();
    &#125;);
&#125;);</pre></div>
<ul class="star">
<li>Edit grails-app/views/book/show.gsp to remove the onclick handler:</li>
</ul><p class="paragraph"/><div class="code"><pre>&#46;..
    &#60;g:actionSubmit class=<span class="java&#45;quote">"delete"</span> action=<span class="java&#45;quote">"delete"</span> value=<span class="java&#45;quote">"$&#123;message(code: '<span class="java&#45;keyword">default</span>.button.delete.label', <span class="java&#45;keyword">default</span>: 'Delete')&#125;"</span> /&#62;
&#46;..</pre></div><p class="paragraph"/>If you run the app now, and go to the page with the delete link, you'll see that the deleteConfirmation.js file is
automatically being included in the page, but we're getting a JavaScript error,
"Uncaught ReferenceError: $ is not defined".  That's because our page depends on jQuery, but we haven't told the
resources plugin.
<ul class="star">
<li>Edit grails-app/conf/ApplicationResources.groovy to declare that our page modules should depend on jQuery (whose module was declared by the jQuery plugin):</li>
</ul><p class="paragraph"/><div class="code"><pre>&#46;..
    defaultPageDependencies &#123;
        dependsOn 'jquery'
    &#125;
&#125;</pre></div><p class="paragraph"/>Now it works properly.<p class="paragraph"/><blockquote class="note">
It's important to use dependsOn rather than simply adding an &#60;r:require&#62; to the GSP, because otherwise the resources
plugin won't know in what order the resources should be included.
</blockquote><p class="paragraph"/>Now, let's say we don't think that the "Book ID deleted" confirmation message after deleting a book stands out enough,
but we want the messages to stay the same on other pages.
<ul class="star">
<li>Create web-app/pages/book/list/list.css:</li>
</ul><p class="paragraph"/><div class="code"><pre>.message &#123;
    font&#45;size: 18px;
&#125;</pre></div><p class="paragraph"/>The new CSS file will be automatically included in that page.


                    </div>
                </td>
                <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
            </tr>
        </table>

        <div id="footer">
            Copyright 2012 David M. Carr and others
            
        </div>



<script type="text/javascript" src="../js/docs.js"></script>

    </body>
</html>
